import type { ForestZone } from "@/types";

export const CARBON_CREDIT_PER_M2 = 0.0002; // 1 m² = 0.0002 tCO₂
export const USD_PER_CREDIT = 3.0; // 1 tCO₂ = $3

// Forest zone data for Cần Giờ mangrove forests
export const FOREST_ZONES: Record<string, ForestZone> = (() => {
  // Helper to scale polygon coordinates outward from center
  function scalePolygon(coords: number[][], scale: number): number[][] {
    // Calculate center
    const n = coords.length;
    let latSum = 0,
      lngSum = 0;
    coords.forEach(([lat, lng]) => {
      latSum += lat;
      lngSum += lng;
    });
    const center = [latSum / n, lngSum / n];
    // Scale each point
    return coords.map(([lat, lng]) => {
      const dLat = lat - center[0];
      const dLng = lng - center[1];
      return [center[0] + dLat * scale, center[1] + dLng * scale];
    });
  }
  // Original zones
  const zones = {
    zoneA: {
      name: "Cần Giờ Mangrove Forest",
      coordinates: scalePolygon(
        [
          [10.438256658595641, 106.91629937629938],
          [10.437530266343826, 106.91546777546777],
          [10.436803874092009, 106.91530145530146],
          [10.436198547215495, 106.91555093555094],
          [10.435714285714285, 106.91621621621623],
          [10.435230024213075, 106.91721413721415],
          [10.434624697336561, 106.91829521829523],
          [10.434140435835351, 106.91945945945946],
          [10.433414043583534, 106.92054054054054],
          [10.432687651331719, 106.92145530145531],
          [10.431719128329297, 106.92203742203743],
          [10.430508474576271, 106.92228690228691],
          [10.42917675544794, 106.92220374220375],
          [10.42772397094431, 106.92203742203743],
          [10.426150121065374, 106.9218711018711],
          [10.424818401937046, 106.92178794178794],
          [10.423365617433413, 106.92203742203743],
          [10.422154963680386, 106.92245322245323],
          [10.42094430992736, 106.92295218295219],
          [10.419733656174333, 106.92353430353431],
          [10.41864406779661, 106.9239501039501],
          [10.417433414043582, 106.92428274428275],
          [10.416343825665859, 106.92436590436591],
          [10.415375302663438, 106.92428274428275],
          [10.41452784503632, 106.9239501039501],
          [10.413922518159806, 106.92345114345115],
          [10.413801452784503, 106.92270270270271],
          [10.413801452784503, 106.92178794178794],
          [10.414164648910411, 106.92079002079002],
          [10.414406779661016, 106.9197920997921],
          [10.414769975786925, 106.9189604989605],
          [10.414891041162226, 106.91829521829523],
          [10.414891041162226, 106.91779625779627],
          [10.414648910411621, 106.91746361746362],
          [10.414285714285715, 106.91721413721415],
          [10.413801452784503, 106.91704781704782],
          [10.413075060532687, 106.9168814968815],
          [10.412227602905569, 106.91671517671519],
          [10.411501210653752, 106.91663201663202],
          [10.410774818401936, 106.9164656964657],
          [10.410290556900726, 106.9164656964657],
          [10.410048426150121, 106.9164656964657],
          [10.410048426150121, 106.91654885654886],
          [10.410169491525423, 106.91671517671519],
          [10.410290556900726, 106.91696465696467],
          [10.410048426150121, 106.91721413721415],
          [10.40956416464891, 106.91762993762994],
          [10.408474576271185, 106.91796257796258],
          [10.407021791767553, 106.91837837837838],
          [10.404963680387409, 106.91871101871102],
          [10.402421307506053, 106.91904365904367],
          [10.399515738498788, 106.91920997920998],
          [10.396004842615012, 106.91937629937631],
          [10.392493946731234, 106.91954261954263],
          [10.388983050847457, 106.91970893970894],
          [10.385714285714286, 106.91995841995842],
          [10.383050847457627, 106.92037422037423],
          [10.38099273607748, 106.92095634095635],
          [10.379297820823243, 106.92170478170479],
          [10.377845036319613, 106.92261954261954],
          [10.376271186440677, 106.92370062370063],
          [10.37457627118644, 106.92486486486487],
          [10.372518159806296, 106.92619542619543],
          [10.370338983050846, 106.92744282744283],
          [10.368159806295399, 106.9287733887734],
          [10.36634382566586, 106.93002079002079],
          [10.36501210653753, 106.93101871101872],
          [10.364285714285714, 106.93193347193348],
          [10.363922518159805, 106.93268191268191],
          [10.363801452784504, 106.9333471933472],
          [10.363922518159805, 106.93392931392931],
          [10.364043583535109, 106.9345945945946],
          [10.363922518159805, 106.93525987525987],
          [10.363922518159805, 106.93592515592516],
          [10.364043583535109, 106.93659043659044],
          [10.364527845036319, 106.93708939708941],
          [10.365496368038741, 106.9375051975052],
          [10.366949152542372, 106.93767151767152],
          [10.368765133171912, 106.93775467775468],
          [10.370702179176755, 106.93775467775468],
          [10.372518159806296, 106.93783783783785],
          [10.37409200968523, 106.937920997921],
          [10.375302663438257, 106.93808731808733],
          [10.376029055690072, 106.9383367983368],
          [10.376271186440677, 106.93858627858629],
          [10.376271186440677, 106.9387525987526],
          [10.37590799031477, 106.93891891891893],
          [10.375423728813558, 106.93883575883576],
          [10.37457627118644, 106.9387525987526],
          [10.37360774818402, 106.93866943866945],
          [10.372397094430992, 106.93866943866945],
          [10.371065375302663, 106.93891891891893],
          [10.369491525423728, 106.93950103950104],
          [10.36779661016949, 106.94016632016633],
          [10.366101694915255, 106.94099792099793],
          [10.364527845036319, 106.9416632016632],
          [10.362953995157385, 106.94224532224533],
          [10.361501210653753, 106.9424948024948],
          [10.360290556900726, 106.94257796257797],
          [10.359200968523002, 106.9424948024948],
          [10.358353510895883, 106.94232848232849],
          [10.357506053268764, 106.94224532224533],
          [10.35690072639225, 106.94224532224533],
          [10.356537530266344, 106.9424948024948],
          [10.35641646489104, 106.9431600831601],
          [10.356658595641646, 106.94424116424116],
          [10.357384987893463, 106.94590436590437],
          [10.358595641646488, 106.94823284823285],
          [10.360169491525424, 106.9510602910603],
          [10.361985472154963, 106.9539708939709],
          [10.363801452784504, 106.95679833679834],
          [10.365375302663438, 106.95912681912682],
          [10.366585956416465, 106.96070686070686],
          [10.367433414043584, 106.96153846153847],
          [10.367917675544794, 106.96178794178795],
          [10.368159806295399, 106.9614553014553],
          [10.368523002421307, 106.96087318087318],
          [10.368886198547216, 106.96004158004159],
          [10.369249394673123, 106.95904365904366],
          [10.369854721549636, 106.95804573804574],
          [10.37046004842615, 106.95704781704782],
          [10.371186440677965, 106.9560498960499],
          [10.371912832929782, 106.95513513513514],
          [10.3727602905569, 106.9543866943867],
          [10.373728813559321, 106.95363825363826],
          [10.374939467312348, 106.9531392931393],
          [10.376271186440677, 106.95264033264034],
          [10.378087167070218, 106.95239085239086],
          [10.38002421307506, 106.95214137214138],
          [10.381961259079903, 106.95214137214138],
          [10.383777239709442, 106.95222453222453],
          [10.385230024213074, 106.95247401247401],
          [10.386198547215496, 106.95288981288982],
          [10.386561743341403, 106.95347193347193],
          [10.38680387409201, 106.95405405405405],
          [10.387046004842615, 106.95455301455301],
          [10.387530266343825, 106.95505197505197],
          [10.388498789346247, 106.95538461538462],
          [10.389951573849878, 106.95546777546778],
          [10.39188861985472, 106.95538461538462],
          [10.393825665859564, 106.95513513513514],
          [10.395883777239709, 106.95471933471934],
          [10.397457627118644, 106.95405405405405],
          [10.398789346246973, 106.95330561330562],
          [10.399636803874092, 106.95247401247401],
          [10.400121065375302, 106.95155925155926],
          [10.400242130750605, 106.95072765072766],
          [10.399999999999999, 106.95006237006237],
          [10.399394673123487, 106.94948024948026],
          [10.398789346246973, 106.94906444906445],
          [10.398062953995156, 106.94873180873181],
          [10.397578692493946, 106.94848232848233],
          [10.39733656174334, 106.94823284823285],
          [10.397578692493946, 106.94798336798337],
          [10.398062953995156, 106.94790020790022],
          [10.398789346246973, 106.94781704781705],
          [10.399636803874092, 106.94798336798337],
          [10.40048426150121, 106.94839916839918],
          [10.401210653753026, 106.94898128898129],
          [10.401937046004843, 106.94964656964657],
          [10.402421307506053, 106.95039501039501],
          [10.402663438256658, 106.95097713097714],
          [10.402663438256658, 106.95130977130978],
          [10.402421307506053, 106.95139293139293],
          [10.402058111380144, 106.95130977130978],
          [10.401573849878934, 106.95114345114345],
          [10.401089588377724, 106.95114345114345],
          [10.400726392251816, 106.95130977130978],
          [10.400605326876512, 106.95180873180874],
          [10.400605326876512, 106.95255717255718],
          [10.400363196125907, 106.95338877338878],
          [10.399757869249393, 106.95430353430353],
          [10.39866828087167, 106.95513513513514],
          [10.396973365617432, 106.95580041580043],
          [10.394794188861985, 106.95629937629938],
          [10.392493946731234, 106.95654885654886],
          [10.390193704600485, 106.95663201663203],
          [10.388135593220339, 106.95654885654886],
          [10.386561743341403, 106.95613305613305],
          [10.38547215496368, 106.9556340956341],
          [10.384745762711864, 106.95513513513514],
          [10.384261501210654, 106.95471933471934],
          [10.38414043583535, 106.95455301455301],
          [10.384019370460049, 106.95463617463618],
          [10.384019370460049, 106.95505197505197],
          [10.383898305084745, 106.9556340956341],
          [10.383535108958837, 106.95638253638253],
          [10.382929782082323, 106.95704781704782],
          [10.382082324455205, 106.9577130977131],
          [10.380871670702179, 106.95829521829522],
          [10.379782082324455, 106.95879417879418],
          [10.378813559322033, 106.95929313929314],
          [10.378450363196125, 106.95970893970895],
          [10.378571428571428, 106.9602079002079],
          [10.379297820823243, 106.96070686070686],
          [10.38050847457627, 106.96120582120582],
          [10.3818401937046, 106.96153846153847],
          [10.383292978208232, 106.96187110187111],
          [10.384745762711864, 106.96203742203743],
          [10.385956416464891, 106.96203742203743],
          [10.386924939467312, 106.96212058212059],
          [10.38777239709443, 106.96212058212059],
          [10.388377723970944, 106.9622869022869],
          [10.388740920096852, 106.96270270270271],
          [10.388983050847457, 106.96311850311851],
          [10.389104116222759, 106.96370062370063],
          [10.389225181598063, 106.96419958419959],
          [10.389346246973366, 106.96453222453223],
          [10.389588377723971, 106.96478170478171],
          [10.390072639225181, 106.96478170478171],
          [10.390556900726391, 106.96469854469855],
          [10.391283292978208, 106.96469854469855],
          [10.392130750605327, 106.96486486486486],
          [10.393099273607747, 106.96528066528067],
          [10.39406779661017, 106.9658627858628],
          [10.395157384987893, 106.96652806652807],
          [10.396246973365617, 106.96719334719336],
          [10.39733656174334, 106.96769230769232],
          [10.39818401937046, 106.96785862785863],
          [10.399031476997578, 106.96769230769232],
          [10.399757869249393, 106.96727650727651],
          [10.400363196125907, 106.96669438669439],
          [10.400726392251816, 106.96602910602911],
          [10.400847457627117, 106.96536382536382],
          [10.400726392251816, 106.96478170478171],
          [10.400605326876512, 106.96419958419959],
          [10.40048426150121, 106.96370062370063],
          [10.400363196125907, 106.96328482328482],
          [10.40048426150121, 106.9629521829522],
          [10.400726392251816, 106.96270270270271],
          [10.401210653753026, 106.96245322245322],
          [10.401694915254236, 106.96237006237007],
          [10.402421307506053, 106.96237006237007],
          [10.403026634382567, 106.96245322245322],
          [10.403753026634382, 106.96261954261955],
          [10.404479418886199, 106.96286902286903],
          [10.405205811138014, 106.96303534303534],
          [10.405811138014528, 106.96311850311851],
          [10.406537530266343, 106.96303534303534],
          [10.40726392251816, 106.96270270270271],
          [10.407869249394672, 106.96237006237007],
          [10.408595641646489, 106.96195426195426],
          [10.409322033898304, 106.96162162162163],
          [10.410048426150121, 106.9614553014553],
          [10.41089588377724, 106.96162162162163],
          [10.411743341404359, 106.96178794178795],
          [10.412590799031477, 106.96203742203743],
          [10.413438256658596, 106.96220374220374],
          [10.414406779661016, 106.96212058212059],
          [10.415254237288135, 106.96178794178795],
          [10.41598062953995, 106.96112266112266],
          [10.416707021791767, 106.96029106029107],
          [10.417433414043582, 106.95912681912682],
          [10.4181598062954, 106.95787941787943],
          [10.418765133171913, 106.9564656964657],
          [10.419370460048425, 106.95496881496882],
          [10.419975786924939, 106.9535550935551],
          [10.420460048426149, 106.9523076923077],
          [10.421065375302662, 106.95139293139293],
          [10.421549636803874, 106.95089397089397],
          [10.422033898305084, 106.95056133056133],
          [10.422397094430993, 106.95047817047818],
          [10.422639225181598, 106.95047817047818],
          [10.4227602905569, 106.95039501039501],
          [10.4227602905569, 106.95006237006237],
          [10.422639225181598, 106.94972972972974],
          [10.422518159806295, 106.94923076923078],
          [10.422397094430993, 106.94881496881497],
          [10.422518159806295, 106.94848232848233],
          [10.422881355932203, 106.94823284823285],
          [10.423486682808717, 106.94798336798337],
          [10.424334140435835, 106.94781704781705],
          [10.42542372881356, 106.94756756756757],
          [10.426634382566585, 106.94715176715177],
          [10.427966101694915, 106.94656964656966],
          [10.429418886198546, 106.9458212058212],
          [10.430871670702178, 106.94498960498962],
          [10.432082324455205, 106.94415800415801],
          [10.433050847457627, 106.94332640332641],
          [10.433777239709443, 106.94266112266112],
          [10.434019370460048, 106.94216216216216],
          [10.434140435835351, 106.9416632016632],
          [10.433898305084744, 106.94133056133056],
          [10.433535108958838, 106.94099792099793],
          [10.432929782082324, 106.94058212058212],
          [10.432203389830509, 106.94024948024949],
          [10.431598062953995, 106.93983367983368],
          [10.430992736077481, 106.93941787941789],
          [10.430629539951573, 106.93900207900208],
          [10.430508474576271, 106.93858627858629],
          [10.430508474576271, 106.93808731808733],
          [10.430750605326876, 106.93758835758837],
          [10.430871670702178, 106.93708939708941],
          [10.430992736077481, 106.93659043659044],
          [10.430992736077481, 106.93609147609148],
          [10.430750605326876, 106.93567567567568],
          [10.430387409200968, 106.93525987525987],
          [10.429903147699758, 106.9350103950104],
          [10.429418886198546, 106.93476091476091],
          [10.42869249394673, 106.93467775467776],
          [10.428087167070217, 106.93476091476091],
          [10.427481840193703, 106.93492723492724],
          [10.426997578692493, 106.93525987525987],
          [10.426513317191283, 106.93567567567568],
          [10.42639225181598, 106.93634095634096],
          [10.42639225181598, 106.93700623700624],
          [10.42639225181598, 106.93775467775468],
          [10.42639225181598, 106.93850311850312],
          [10.426150121065374, 106.93908523908524],
          [10.42554479418886, 106.93941787941789],
          [10.424697336561742, 106.93966735966737],
          [10.423728813559322, 106.93966735966737],
          [10.422881355932203, 106.9395841995842],
          [10.42227602905569, 106.93941787941789],
          [10.42227602905569, 106.93925155925156],
          [10.4227602905569, 106.93900207900208],
          [10.423607748184018, 106.93883575883576],
          [10.42457627118644, 106.93858627858629],
          [10.42542372881356, 106.93841995841996],
          [10.426029055690073, 106.93808731808733],
          [10.426150121065374, 106.93783783783785],
          [10.426150121065374, 106.93742203742204],
          [10.42590799031477, 106.93692307692308],
          [10.425665859564164, 106.93634095634096],
          [10.42542372881356, 106.93567567567568],
          [10.42542372881356, 106.93484407484408],
          [10.42554479418886, 106.93392931392931],
          [10.426029055690073, 106.93301455301456],
          [10.426755447941888, 106.93218295218296],
          [10.427845036319612, 106.93135135135135],
          [10.42917675544794, 106.93076923076923],
          [10.430871670702178, 106.93018711018712],
          [10.432566585956415, 106.92968814968816],
          [10.434140435835351, 106.92918918918919],
          [10.43547215496368, 106.92860706860708],
          [10.436561743341404, 106.92802494802496],
          [10.437409200968522, 106.92735966735967],
          [10.438014527845036, 106.9266943866944],
          [10.438498789346246, 106.9260291060291],
          [10.438861985472155, 106.925446985447],
          [10.43910411622276, 106.92486486486487],
          [10.439225181598061, 106.92436590436591],
          [10.439346246973365, 106.9239501039501],
          [10.439346246973365, 106.92361746361748],
          [10.439225181598061, 106.92320166320167],
          [10.43910411622276, 106.92286902286902],
          [10.438740920096851, 106.92253638253639],
          [10.438377723970943, 106.92220374220375],
          [10.437772397094431, 106.9218711018711],
          [10.437046004842614, 106.92153846153846],
        ],
        4
      ),
      color: "#22c55e",
      credits: 4250,
      area: 850,
      description: "Primary mangrove conservation area with high biodiversity.",
      status: "Active",
    },
    zoneB: {
      name: "Xuân Thủy National Park",
      coordinates: scalePolygon(
        [
          [20.2167, 106.5833],
          [20.22, 106.59],
          [20.21, 106.59],
          [20.21, 106.58],
          [20.2167, 106.5833],
        ],
        1.5
      ),
      color: "#3b82f6",
      credits: 3750,
      area: 750,
      description: "Vietnam's first Ramsar site, important for migratory birds.",
      status: "Active",
    },
    zoneC: {
      name: "Cúc Phương National Park",
      coordinates: scalePolygon(
        [
          [20.3167, 105.6067],
          [20.32, 105.61],
          [20.31, 105.61],
          [20.31, 105.6],
          [20.3167, 105.6067],
        ],
        1.5
      ),
      color: "#8b5cf6",
      credits: 1110,
      area: 222,
      description: "Vietnam's oldest national park, rich in flora and fauna.",
      status: "Monitoring",
    },
    zoneD: {
      name: "Bạch Mã National Park",
      coordinates: scalePolygon(
        [
          [16.2, 107.86],
          [16.21, 107.87],
          [16.19, 107.87],
          [16.19, 107.86],
          [16.2, 107.86],
        ],
        1.5
      ),
      color: "#f59e42",
      credits: 1850,
      area: 370,
      description: "Mountainous park with cloud forests and waterfalls.",
      status: "Active",
    },
    zoneE: {
      name: "Yok Đôn National Park",
      coordinates: scalePolygon(
        [
          [12.8, 107.6833],
          [12.81, 107.69],
          [12.79, 107.69],
          [12.79, 107.68],
          [12.8, 107.6833],
        ],
        1.5
      ),
      color: "#e11d48",
      credits: 5775,
      area: 1155,
      description: "Largest national park in Vietnam, home to elephants and rare birds.",
      status: "Active",
    },
    zoneF: {
      name: "Tràm Chim National Park",
      coordinates: scalePolygon(
        [
          [10.7, 105.5],
          [10.71, 105.51],
          [10.69, 105.51],
          [10.69, 105.5],
          [10.7, 105.5],
        ],
        1.5
      ),
      color: "#fbbf24",
      credits: 3790,
      area: 758,
      description: "Wetland reserve, famous for Sarus cranes and aquatic biodiversity.",
      status: "Monitoring",
    },
    zoneG: {
      name: "Ba Vì National Park",
      coordinates: scalePolygon(
        [
          [21.07, 105.37],
          [21.08, 105.38],
          [21.06, 105.38],
          [21.06, 105.37],
          [21.07, 105.37],
        ],
        1.5
      ),
      color: "#10b981",
      credits: 540,
      area: 108,
      description: "Mountainous park near Hanoi, known for diverse plant species.",
      status: "Active",
    },
    zoneH: {
      name: "Phú Quốc National Park",
      coordinates: scalePolygon(
        [
          [10.3, 103.9833],
          [10.31, 103.99],
          [10.29, 103.99],
          [10.29, 103.98],
          [10.3, 103.9833],
        ],
        1.5
      ),
      color: "#6366f1",
      credits: 1570,
      area: 314,
      description: "Island park with tropical forests and rich marine life.",
      status: "Active",
    },
    zoneI: {
      name: "Tam Đảo National Park",
      coordinates: scalePolygon(
        [
          [21.5, 105.5833],
          [21.51, 105.59],
          [21.49, 105.59],
          [21.49, 105.58],
          [21.5, 105.5833],
        ],
        1.5
      ),
      color: "#f472b6",
      credits: 1800,
      area: 360,
      description: "Mountainous park with cool climate and rare animal species.",
      status: "Active",
    },
    zoneJ: {
      name: "Đà Lạt Pine Forests",
      coordinates: scalePolygon(
        [
          [11.9404, 108.4583],
          [11.95, 108.47],
          [11.93, 108.47],
          [11.93, 108.46],
          [11.9404, 108.4583],
        ],
        1.5
      ),
      color: "#0ea5e9",
      credits: 2700,
      area: 540,
      description: "Highland pine forests, famous for scenic beauty and cool climate.",
      status: "Active",
    },
  };
  return zones;
})();

// Calculate polygon area (simplified version)
export const calculatePolygonArea = (coordinates: number[][]): number => {
  let area = 0;
  const n = coordinates.length;

  for (let i = 0; i < n; i++) {
    const j = (i + 1) % n;
    area += coordinates[i][0] * coordinates[j][1];
    area -= coordinates[j][0] * coordinates[i][1];
  }

  return (Math.abs(area) * 111320 * 111320) / 2; // Rough conversion to m²
};

// Calculate carbon credits from area
export const calculateCarbonCredits = (areaM2: number): number => {
  return areaM2 * CARBON_CREDIT_PER_M2;
};

// Calculate USD value from carbon credits
export const calculateUSDValue = (credits: number): number => {
  return credits * USD_PER_CREDIT;
};
